<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Seed Whitelist</title>
</head>

<body>
    <h1>Seeding Allowed Users...</h1>
    <div id="status">Starting...</div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCSCj5PAkFr9Rl-yA2-qBeE4GacWoS63b0",
            authDomain: "fantasfs2026.firebaseapp.com",
            projectId: "fantasfs2026",
            storageBucket: "fantasfs2026.firebasestorage.app",
            messagingSenderId: "794313055029",
            appId: "1:794313055029:web:7ac9b30e0b603638dd8a7c"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // EDIT THIS LIST LOCALLY BEFORE RUNNING if you want to add more
        const initialEmails = [
            "carlogrigioni@gmail.com",
            "carlogrigionitest@gmail.com"
        ];

        async function seed() {
            const status = document.getElementById('status');
            try {
                for (const email of initialEmails) {
                    // We use the email as the Document ID for easy lookup
                    // Collection: 'allowed_users'
                    await setDoc(doc(db, "allowed_users", email), {
                        enabled: true,
                        createdAt: new Date().toISOString()
                    });
                    status.innerText += `\nAdded: ${email}`;
                }

                status.innerText += "\n\nDONE! whitelist is now in Firestore.";
            } catch (error) {
                console.error(error);
                status.innerText += `\nERROR: ${error.message}`;
                status.innerText += `\n\nCheck your Security Rules if you get permission errors!`;
            }
        }

        seed();
    </script>
</body>

</html>